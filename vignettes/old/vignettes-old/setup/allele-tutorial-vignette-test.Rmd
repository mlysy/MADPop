---
title: "Hierarchial Hardy-Weinberg Analysis of Variable Alleled Fish"
author: "Martin Lysy, Wookjung P. Kim"
date: "September 23, 2015"
output: html_document
---
#
#
**TUTORIAL**

There are many steps in this tutorial that are labelled STEP 1 to STEP 6. Each step has a "PURPOSE" written below for explanation of the step.
Throughout each of the steps there will be a "NOTE" as guidance.

```{r}
require(mapsAllele)
```

#
#
**STEP 0.**

PURPOSE: Clean up dataset. For a preloaded dataset, skip to STEP 1.

See mapsAllele/extdata/fish215-cleanup.R

#
#
**STEP 1.**
PURPOSE: Calculate some summary statistics for the data, in order to:
(1) simulate datasets which satisfy the Hardy-Weinberg equilibrium
(2) draw MCMC samples for posterior inference.
To proceed directly to inference go to step 2.

```{r}
head(fish215)

#*******
# Here are two lakes under consideration: Simcoe and Michipicoten
lnames <- c("Simcoe", "Michipicoten")
Xobs <- fish215[fish215$Lake %in% lnames,]
head(Xobs)
# Pool these under the null hypothesis:
#
# H0: the two lakes have the same Hardy-Weinberg equilibrium conditions.
#
Xsuff <- HW.suff(X = Xobs[,-1])
# converts the fish data Xobs into statistics including:
#   A: total set of unique alleles
#   G: total set of unique full genotypes (combination of 4 alleles)
#   Xg: counts in each unique genotype from observed data
#   H: total set of possible inherited genotypes (combination of 2 alleles)
#       with repeats being 1 inherited allele
#   Y: observed data in a simplified numerical format
```
